import "tfconfig"

restrict_resources = func() {
  allowed_resource_types = ["null_resource"]
  validated = true

  for tfconfig.resources as type, resource {
    if type + "_" + resource not in allowed_resource_types {
      print("Resources not allowed", type + "_" + resource)
      validated = false
    }
  }

  return validated
}

resources_restricted = restrict_resources()

main = rule {
  resources_restricted
}
