import "tfconfig"
import "strings"

validate_module_sources = func() {
  validated = true

  for tfconfig.modules as _, module {
    if strings.has_prefix(module.source, "github.com/rmadamanchi") {
      print("Module permitted", module.source)
    }else {
      print("Module source not allowed", module.source)
      validated = false
    }
  }

  return validated
}

module_sources_validated = validate_module_sources()

main = rule {
  module_sources_validated
}
